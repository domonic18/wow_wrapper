<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Ban List</title>
	<style>
		table, th, td {
			border: 1px solid black;
			border-collapse: collapse;
			padding: 8px;
		}
	</style>
</head>
<body>
	<table id="ban-list">
		<thead>
			<tr>
				<th>封号日期</th>
				<th>封号ID</th>
				<th>所属IP</th>
				<th>封号时长</th>
				<th>封号原因</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>
	<script>
		const url = 'http://lokta.cn/web-api/launcher/index.php?_key=ffc312f882fbeeb51504483ee8c691a2&_url=ban_list';

		fetch(url)
			.then(response => response.json())
			.then(data => {
				const tbody = document.querySelector('#ban-list tbody');
				data.forEach(rowData => {
					const row = document.createElement('tr');
					row.innerHTML = `
						<td>${rowData.bandate}</td>
						<td>${rowData.username}</td>
						<td>${rowData.last_ip}</td>
						<td>${rowData.bandate === rowData.unbandate ? '永久封号' : getBanDuration(rowData.bandate, rowData.unbandate)}</td>
						<td>${rowData.banreason}</td>
					`;
					tbody.appendChild(row);
				});
			})
			.catch(error => console.error(error));

		function getBanDuration(bandate, unbandate) {
			const seconds = (new Date(unbandate).getTime() - new Date(bandate).getTime()) / 1000;
			const days = Math.floor(seconds / 86400);
			const hours = Math.floor((seconds % 86400) / 3600);
			const minutes = Math.floor((seconds % 3600) / 60);
			const secondsLeft = Math.floor(seconds % 60);
			return `${days} 天 ${hours} 小时 ${minutes} 分钟 ${secondsLeft} 秒`;
		}
	</script>
</body>
</html>